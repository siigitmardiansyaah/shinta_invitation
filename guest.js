(()=>{var H=(()=>{let n=null,o=null,c=0,r=0,f=!0,s=()=>{c+=1},l=()=>`(${r}/${c}) [${parseInt(r/c*100).toFixed(0)}%]`;return{init:()=>{n=document.getElementById("progress-info"),o=document.getElementById("progress-bar"),n.style.display="block"},add:s,invalid:w=>{f=!1,o.style.backgroundColor="red",n.innerText=`Error loading ${w} ${l()}`},complete:w=>{f&&(r+=1,n.innerText=`Loading ${w} complete ${l()}`,o.style.width=Math.min(r/c*100,100).toString()+"%",r===c&&document.dispatchEvent(new Event("progress.done")))}}})();var J=(()=>{let n=null,o=null,c=!0,r=1e3*60*60*6,f="images",s=async b=>{let u=b.getAttribute("data-src"),d="x-expiration-time",y=new Image;if(y.onload=()=>{b.src=y.src,b.width=y.width,b.height=y.height,H.complete("image")},n.has(u)){y.src=n.get(u);return}let x=k=>new Promise((a,t)=>{let g=document.createElement("canvas");g.width=k.width,g.height=k.height,g.getContext("2d").drawImage(k,0,0);let e=i=>{i?a(i):t(new Error("Failed to convert image to WebP"))};g.onerror=t,g.toBlob(e,"image/webp",.8)}),v=(k,a=3,t=1e3)=>fetch(u).then(g=>g.blob()).then(g=>window.createImageBitmap(g)).then(g=>x(g)).then(g=>{let e=new Headers;return e.set("Content-Type","image/webp"),e.set("Content-Length",String(g.size)),e.set(d,String(Date.now()+r)),k.put(u,new Response(g,{headers:e})).then(()=>g)}).catch(g=>{if(a<=0)throw g;return console.warn("Retrying fetch:"+u),new Promise(e=>setTimeout(()=>e(v(k,a-1,t+500)),t))}),E=k=>k.match(u).then(a=>a?Date.now()<=parseInt(a.headers.get(d))?a.blob():k.delete(u).then(t=>t?v(k):a.blob()):v(k));await caches.open(f).then(k=>E(k)).then(k=>{y.src=URL.createObjectURL(k),n.set(u,y.src)}).catch(()=>H.invalid("image"))},l=b=>{b.onerror=()=>H.invalid("image"),b.onload=()=>{b.width=b.naturalWidth,b.height=b.naturalHeight,H.complete("image")},b.complete&&b.naturalWidth!==0&&b.naturalHeight!==0?H.complete("image"):b.complete&&H.invalid("image")},p=()=>c,m=b=>{r=Number(b)},h=()=>{(async()=>{for(let b of o)b.hasAttribute("data-src")?await s(b):l(b)})()};return{init:()=>(n=new Map,o=document.querySelectorAll("img"),o.forEach(H.add),c=Array.from(o).some(b=>b.hasAttribute("data-src")),{load:h,setTtl:m,hasDataSrc:p})}})();var G=(()=>{let n=null,o=null,c=!1,r='<i class="fa-solid fa-circle-pause spin-button"></i>',f='<i class="fa-solid fa-circle-play"></i>',s=async()=>{if(navigator.onLine){n.disabled=!0;try{await o.play(),c=!0,n.disabled=!1,n.innerHTML=r}catch(m){c=!1,alert(m)}}},l=()=>{c=!1,o.pause(),n.innerHTML=f};return{init:()=>{n=document.getElementById("button-music"),n.style.display="block",o=new Audio(n.getAttribute("data-url")),o.volume=1,o.loop=!0,o.muted=!1,o.currentTime=0,o.autoplay=!1,o.controls=!1,o.addEventListener("canplay",s),n.addEventListener("offline",l),n.addEventListener("click",()=>c?l():s())}}})();var $=(()=>{let n=m=>String(m).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),o=(m,h)=>{let w=null;w=setTimeout(()=>{m(),clearTimeout(w),w=null},h)};return{copy:async(m,h=null,w=1500)=>{let b=m.getAttribute("data-copy");if(!b||b.length===0){alert("Nothing to copy");return}m.disabled=!0;try{await navigator.clipboard.writeText(b)}catch{m.disabled=!1,alert("Failed to copy");return}let u=m.innerHTML;m.innerHTML=h||'<i class="fa-solid fa-check"></i>',o(()=>{m.disabled=!1,m.innerHTML=u},w)},timeOut:o,escapeHtml:n,base64Encode:m=>{let w=new TextEncoder().encode(m);return window.btoa(String.fromCharCode(...w))},base64Decode:m=>{let h=new TextDecoder,w=Uint8Array.from(window.atob(m),b=>b.charCodeAt(0));return h.decode(w)},disableButton:(m,h="Loading")=>{m.disabled=!0;let w=m.innerHTML;return m.innerHTML=`<span class="spinner-border spinner-border-sm my-0 ms-0 me-1 p-0" style="height: 0.8rem; width: 0.8rem"></span>${h}`,{restore:()=>{m.innerHTML=w,m.disabled=!1}}},disableCheckbox:m=>{m.disabled=!0;let h=document.querySelector(`label[for="${m.id}"]`),w=h.innerHTML;return h.innerHTML=`<span class="spinner-border spinner-border-sm my-0 ms-0 me-1 p-0" style="height: 0.8rem; width: 0.8rem"></span>${w}`,{restore:()=>{h.innerHTML=w,m.disabled=!1}}},parseUserAgent:m=>{let h=[{type:"Mobile",regex:/Android.*Mobile|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i},{type:"Tablet",regex:/iPad|Android(?!.*Mobile)|Tablet/i},{type:"Desktop",regex:/Windows NT|Macintosh|Linux/i}],w=[{name:"Chrome",regex:/Chrome|CriOS/i},{name:"Safari",regex:/Safari/i},{name:"Edge",regex:/Edg|Edge/i},{name:"Firefox",regex:/Firefox|FxiOS/i},{name:"Opera",regex:/Opera|OPR/i},{name:"Internet Explorer",regex:/MSIE|Trident/i}],b=[{name:"Windows",regex:/Windows NT ([\d.]+)/i},{name:"MacOS",regex:/Mac OS X ([\d_]+)/i},{name:"Android",regex:/Android ([\d.]+)/i},{name:"iOS",regex:/OS ([\d_]+) like Mac OS X/i},{name:"Linux",regex:/Linux/i}],u=h.find(E=>E.regex.test(m))?.type||"Unknown",d=w.find(E=>E.regex.test(m))?.name||"Unknown",y=b.find(E=>E.regex.test(m)),x=y&&m.match(y.regex)?.[1]?.replace(/_/g,".")||"",v=y?y.name:"Unknown";return x=x?`${v} ${x}`:v,`${d} ${u} ${x}`}}})();var K={tab:c=>window.bootstrap.Tab.getOrCreateInstance(document.getElementById(c)),modal:c=>window.bootstrap.Modal.getOrCreateInstance(document.getElementById(c))};var L=n=>{let o=(l=null)=>{let p=JSON.parse(localStorage.getItem(n));return l?p[String(l)]:p},c=(l,p)=>{let m=o();m[String(l)]=p,localStorage.setItem(n,JSON.stringify(m))},r=l=>Object.keys(o()).includes(String(l)),f=l=>{if(!r(l))return;let p=o();delete p[String(l)],localStorage.setItem(n,JSON.stringify(p))},s=()=>localStorage.setItem(n,"{}");return localStorage.getItem(n)||s(),{set:c,get:o,has:r,clear:s,unset:f}};var F=(()=>{let n={"#000000":"#ffffff","#ffffff":"#000000","#212529":"#f8f9fa","#f8f9fa":"#212529"},o=["#ffffff","#f8f9fa"],c=["#000000","#212529"],r=!1,f=null,s=null,l=()=>f.set("active","light"),p=()=>f.set("active","dark"),m=v=>{let E=s.getAttribute("content");s.setAttribute("content",v.some(k=>k===E)?n[E]:E)},h=()=>{l(),document.documentElement.setAttribute("data-bs-theme","light"),m(c)},w=()=>{p(),document.documentElement.setAttribute("data-bs-theme","dark"),m(o)},b=(v=null,E=null)=>{let k=f.get("active")==="dark";return v&&E?k?v:E:k};return{init:()=>{switch(f=L("theme"),s=document.querySelector('meta[name="theme-color"]'),f.has("active")||(window.matchMedia("(prefers-color-scheme: dark)").matches?p():l()),document.documentElement.getAttribute("data-bs-theme")){case"dark":p();break;case"light":l();break;default:r=!0}b()?w():h()},spyTop:()=>{let v=k=>k.filter(a=>a.isIntersecting).forEach(a=>{let t=a.target.classList.contains("bg-white-black")?b(c[0],o[0]):b(c[1],o[1]);s.setAttribute("content",t)}),E=new IntersectionObserver(v,{rootMargin:"0% 0% -95% 0%"});document.querySelectorAll("section").forEach(k=>E.observe(k))},change:()=>b()?h():w(),isDarkMode:b,isAutoMode:()=>r}})();var M=(()=>{let n=(u,d,y)=>({code:u,data:d,error:y}),o=(u=0)=>({love:u}),c=({uuid:u,own:d,name:y,presence:x,comment:v,created_at:E,is_admin:k,ip:a,user_agent:t,comments:g,like:e})=>({uuid:u,own:d,name:y,presence:x,comment:v,created_at:E,is_admin:k??!1,ip:a,user_agent:t,comments:g?.map(c)??[],like:o(e?.love??0)});return{uuidResponse:({uuid:u})=>({uuid:u}),baseResponse:n,tokenResponse:({token:u})=>({token:u}),statusResponse:({status:u})=>({status:u}),commentResponse:({name:u,presence:d,comment:y,is_admin:x,created_at:v})=>({name:u,presence:d,comment:y,is_admin:x,created_at:v}),likeCommentResponse:o,getCommentResponse:c,getCommentsResponse:u=>u.map(c),commentShowMore:(u,d=!1)=>({uuid:u,show:d}),postCommentRequest:(u,d,y,x)=>({id:u,name:d,presence:y,comment:x}),postSessionRequest:(u,d)=>({email:u,password:d}),updateCommentRequest:(u,d)=>({presence:u,comment:d})}})();var j="GET",Z="PUT",U="POST",X="PATCH",Y="DELETE",z=200,V=201,ie=500,O=(n,o)=>{let c=new AbortController,r=document.body.getAttribute("data-url"),f={signal:c.signal,method:String(n).toUpperCase(),headers:new Headers({Accept:"application/json","Content-Type":"application/json"})};return window.addEventListener("offline",()=>c.abort()),window.addEventListener("popstate",()=>c.abort()),window.addEventListener("beforeunload",()=>c.abort()),r.slice(-1)==="/"&&(r=r.slice(0,-1)),{send(s=null){return fetch(r+o,f).then(l=>l.json().then(p=>{if(l.status>=ie&&(p.message??p[0]))throw new Error(p.message??p[0]);if(p.error)throw new Error(p.error[0]);return s&&(p.data=s(p.data)),M.baseResponse(p.code,p.data,p.error)})).catch(l=>{if(l.name==="AbortError")return console.warn("Fetch abort:",l),l;throw alert(l),new Error(l)})},download(){return fetch(r+o,f).then(s=>{if(s.status!==z)return!1;let l=document.querySelector("a[download]");l&&document.body.removeChild(l);let p=s.headers.get("content-disposition")?.match(/filename="(.+)"/)?.[1]??"download.csv";return s.blob().then(m=>{let h=document.createElement("a"),w=window.URL.createObjectURL(m);return h.href=w,h.download=p,document.body.appendChild(h),h.click(),document.body.removeChild(h),window.URL.revokeObjectURL(w),!0})}).catch(s=>{if(s.name==="AbortError")return console.warn("Fetch abort:",s),s;throw alert(s),new Error(s)})},token(s){return s.split(".").length===3?(f.headers.append("Authorization","Bearer "+s),this):(f.headers.append("x-access-key",s),this)},body(s){return f.body=JSON.stringify(s),this}}};var S=(()=>{let n=null,o=()=>n.get("token"),c=h=>n.set("token",h),r=h=>O(U,"/api/session").body(h).send(M.tokenResponse).then(w=>(w.code===z&&c(w.data.token),w.code===z),()=>!1),f=()=>n.unset("token"),s=()=>String(o()??".").split(".").length===3;return{init:()=>{n=L("session")},guest:()=>O(j,"/api/config").token(o()).send().then(h=>{if(h.code!==z)throw new Error("failed to get config.");let w=L("config");for(let[b,u]of Object.entries(h.data))w.set(b,u);return h}),login:r,logout:f,decode:()=>{if(!s())return null;try{return JSON.parse(window.atob(o().split(".")[1]))}catch{return null}},isAdmin:s,setToken:c,getToken:o}})();var Q=(()=>{let n=null,o=!0,c=()=>o,r=u=>new Promise(d=>{let y=parseFloat(n.style.opacity),x=null,v=u?.05:-.05,E=u?1:0;x=setInterval(()=>{y=Math.max(0,Math.min(1,y+v)),n.style.opacity=y.toFixed(2),y===E&&(d(),clearInterval(x),x=null)},10)}),f=()=>{let u=n.firstElementChild.firstElementChild;u.classList.remove("bg-success"),u.classList.add("bg-danger"),u.firstElementChild.innerHTML='<i class="fa-solid fa-ban me-2"></i>Koneksi tidak tersedia'},s=()=>{let u=n.firstElementChild.firstElementChild;u.classList.remove("bg-danger"),u.classList.add("bg-success"),u.firstElementChild.innerHTML='<i class="fa-solid fa-cloud me-2"></i>Koneksi tersedia kembali'},l=async()=>{await r(!1),f()},p=()=>{let u=null;u=setTimeout(()=>{clearTimeout(u),u=null,o&&l()},3e3)},m=()=>{let u=["input[data-offline-disabled]","button[data-offline-disabled]","select[data-offline-disabled]","textarea[data-offline-disabled]"].join(", ");document.querySelectorAll(u).forEach(d=>{d.dispatchEvent(new Event(c()?"online":"offline")),d.setAttribute("data-offline-disabled",c()?"false":"true"),d.tagName==="BUTTON"?c()?d.classList.remove("disabled"):d.classList.add("disabled"):c()?d.removeAttribute("disabled"):d.setAttribute("disabled","true")})},h=()=>{o=!1,f(),r(!0),m()},w=()=>{o=!0,s(),p(),m()};return{init:()=>{window.addEventListener("online",w),window.addEventListener("offline",h),n=document.getElementById("offline-mode"),n.innerHTML=`
        <div class="d-flex justify-content-center mx-auto">
            <div class="d-flex justify-content-center align-items-center rounded-pill my-2 bg-danger shadow">
                <small class="text-center py-1 px-2 mx-1 mt-1 mb-0 text-white" style="font-size: 0.8rem;"></small>
            </div>
        </div>`},isOnline:c}})();var R=(()=>{let n=null,o=null,c=null,r=null,f=null,s=null,l=250,p=()=>`
        <div class="bg-theme-auto shadow p-3 mx-0 mt-0 mb-3 rounded-4">
            <div class="d-flex flex-wrap justify-content-between align-items-center placeholder-wave">
                <span class="placeholder bg-secondary col-5 rounded-3 my-1"></span>
                <span class="placeholder bg-secondary col-3 rounded-3 my-1"></span>
            </div>
            <hr class="my-1">
            <p class="placeholder-wave m-0">
                <span class="placeholder bg-secondary col-6 rounded-3"></span>
                <span class="placeholder bg-secondary col-5 rounded-3"></span>
                <span class="placeholder bg-secondary col-12 rounded-3 my-1"></span>
            </p>
        </div>`,m=e=>([["*",'<strong class="text-theme-auto">$1</strong>'],["_",'<em class="text-theme-auto">$1</em>'],["~",'<del class="text-theme-auto">$1</del>'],["```",'<code class="font-monospace text-theme-auto">$1</code>']].forEach(T=>{let A=T[0],P=T[1];e=e.replace(new RegExp(`\\${A}(?=\\S)(.*?)(?<!\\s)\\${A}`,"gs"),P)}),e),h=e=>`
        <button style="font-size: 0.8rem;" onclick="undangan.comment.like.love(this)" data-uuid="${e.uuid}" class="btn btn-sm btn-outline-auto ms-auto rounded-3 p-0 shadow-sm d-flex justify-content-start align-items-center" data-offline-disabled="false">
            <span class="my-0 mx-1" data-count-like="${e.like.love}">${e.like.love}</span>
            <i class="me-1 ${c.has(e.uuid)?"fa-solid fa-heart text-danger":"fa-regular fa-heart"}"></i>
        </button>`,w=e=>{let i=`<div class="d-flex flex-wrap justify-content-start align-items-center" data-button-action="${e.uuid}">`;return(r.get("can_reply")===!0||r.get("can_reply")===void 0)&&(i+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.reply(this)" data-uuid="${e.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-offline-disabled="false">Reply</button>`),o.has(e.uuid)&&(r.get("can_edit")===!0||r.get("can_edit")===void 0)&&(i+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.edit(this)" data-uuid="${e.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-offline-disabled="false">Edit</button>`),S.isAdmin()?i+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.remove(this)" data-uuid="${e.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-own="${e.own}" data-offline-disabled="false">Delete</button>`:o.has(e.uuid)&&(r.get("can_delete")===!0||r.get("can_delete")===void 0)&&(i+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.remove(this)" data-uuid="${e.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-offline-disabled="false">Delete</button>`),i+="</div>",i},b=(e,i)=>{let T=s.get("show").includes(e);return`<a class="text-theme-auto" style="font-size: 0.8rem;" onclick="undangan.comment.showOrHide(this)" data-uuid="${e}" data-uuids="${i.join(",")}" data-show="${T?"true":"false"}" role="button" class="me-auto ms-1 py-0">${T?"Hide replies":`Show replies (${i.length})`}</a>`},u=e=>`
        <div class="d-flex flex-wrap justify-content-between align-items-center" id="button-${e.uuid}">
            ${w(e)}
            ${e.comments.length>0?b(e.uuid,e.comments.map(i=>i.uuid)):""}
            ${h(e)}
        </div>`,d=e=>e.ip===void 0||e.user_agent===void 0||e.is_admin?"":`
        <div class="mb-1 mt-3">
            <p class="text-theme-auto mb-1 mx-0 mt-0 p-0" style="font-size: 0.7rem;" id="ip-${e.uuid}"><i class="fa-solid fa-location-dot me-1"></i>${$.escapeHtml(e.ip)} ${f.has(e.ip)?`<strong>${f.get(e.ip)}</strong>`:'<span class="mb-1 placeholder col-2 rounded-3"></span>'}</p>
            <p class="text-theme-auto m-0 p-0" style="font-size: 0.7rem;"><i class="fa-solid fa-mobile-screen-button me-1"></i>${$.parseUserAgent($.escapeHtml(e.user_agent))}</p>
        </div>`,y=(e,i)=>i?'class="bg-theme-auto shadow p-3 mx-0 mt-0 mb-3 rounded-4" data-parent="true"':`class="${s.get("hidden").find(T=>T.uuid===e.uuid).show?"":"d-none"} overflow-x-scroll mw-100 border-start bg-theme-auto py-2 ps-2 pe-0 my-2 ms-2 me-0"`,x=(e,i)=>e.is_admin?`<strong class="me-1">${$.escapeHtml(n.get("name")??r.get("name"))}</strong><i class="fa-solid fa-certificate text-primary"></i>`:i?`<strong class="me-1">${$.escapeHtml(e.name)}</strong><i id="badge-${e.uuid}" class="fa-solid ${e.presence?"fa-circle-check text-success":"fa-circle-xmark text-danger"}"></i>`:`<strong>${$.escapeHtml(e.name)}</strong>`,v=(e,i)=>{let T=m($.escapeHtml(e.comment)),A=T.length>l;return`
        <div class="d-flex flex-wrap justify-content-between align-items-center">
            <p class="text-theme-auto text-truncate m-0 p-0" style="font-size: 0.95rem;">${x(e,i)}</p>
            <small class="text-theme-auto m-0 p-0" style="font-size: 0.75rem;">${e.created_at}</small>
        </div>
        <hr class="my-1">
        <p class="text-theme-auto my-1 mx-0 p-0" style="white-space: pre-wrap !important; font-size: 0.95rem;" ${A?`data-comment="${$.base64Encode(T)}"`:""} id="content-${e.uuid}">${A?T.slice(0,l)+"...":T}</p>
        ${A?`<p class="mb-2 mt-0 mx-0 p-0"><a class="text-theme-auto" role="button" style="font-size: 0.85rem; display: block;" data-show="false" onclick="undangan.comment.showMore(this, '${e.uuid}')">Selengkapnya</a></p>`:""}`},E=(e,i)=>`
        <div ${y(e,i)} id="${e.uuid}" style="overflow-wrap: break-word !important;">
            <div id="body-content-${e.uuid}" data-tapTime="0" data-liked="false" tabindex="0">
            ${v(e,i)}
            </div>
            ${d(e)}
            ${u(e)}
            <div id="reply-content-${e.uuid}">${e.comments.map(T=>k(T)).join("")}</div>
        </div>`,k=e=>E(e,!1);return{init:()=>{n=L("user"),o=L("owns"),c=L("likes"),r=L("config"),f=L("tracker"),s=L("comment")},renderEdit:(e,i)=>{let T=document.createElement("div");return T.classList.add("my-2"),T.id=`inner-${e}`,T.innerHTML=`
        <label for="form-inner-${e}" class="form-label my-1" style="font-size: 0.95rem;"><i class="fa-solid fa-pen me-2"></i>Edit</label>
        ${document.getElementById(e).getAttribute("data-parent")==="true"&&!S.isAdmin()?`
        <select class="form-select shadow-sm mb-2 rounded-4" id="form-inner-presence-${e}" data-offline-disabled="false">
            <option value="1" ${i?"selected":""}>Datang</option>
            <option value="2" ${i?"":"selected"}>Berhalangan</option>
        </select>`:""}
        <textarea class="form-control shadow-sm rounded-4 mb-2" id="form-inner-${e}" minlength="1" maxlength="1000" placeholder="Type update comment" rows="3" data-offline-disabled="false"></textarea>
        <div class="d-flex flex-wrap justify-content-end align-items-center mb-0">
            <button style="font-size: 0.8rem;" onclick="undangan.comment.cancel('${e}')" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1" data-offline-disabled="false">Cancel</button>
            <button style="font-size: 0.8rem;" onclick="undangan.comment.update(this)" data-uuid="${e}" class="btn btn-sm btn-outline-auto rounded-4 py-0" data-offline-disabled="false">Update</button>
        </div>`,T},renderReply:e=>{let i=document.createElement("div");return i.classList.add("my-2"),i.id=`inner-${e}`,i.innerHTML=`
        <label for="form-inner-${e}" class="form-label my-1" style="font-size: 0.95rem;"><i class="fa-solid fa-reply me-2"></i>Reply</label>
        <textarea class="form-control shadow-sm rounded-4 mb-2" id="form-inner-${e}" minlength="1" maxlength="1000" placeholder="Type reply comment" rows="3" data-offline-disabled="false"></textarea>
        <div class="d-flex flex-wrap justify-content-end align-items-center mb-0">
            <button style="font-size: 0.8rem;" onclick="undangan.comment.cancel('${e}')" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1" data-offline-disabled="false">Cancel</button>
            <button style="font-size: 0.8rem;" onclick="undangan.comment.send(this)" data-uuid="${e}" class="btn btn-sm btn-outline-auto rounded-4 py-0" data-offline-disabled="false">Send</button>
        </div>`,i},renderLoading:p,renderReadMore:b,renderInnerContent:k,renderContent:e=>E(e,!0),convertMarkdownToHTML:m,maxCommentLength:l}})();var ee=()=>window.confetti.shapeFromPath({path:"M167 72c19,-38 37,-56 75,-56 42,0 76,33 76,75 0,76 -76,151 -151,227 -76,-76 -151,-151 -151,-227 0,-42 33,-75 75,-75 38,0 57,18 76,56z",matrix:[.03333333333333333,0,0,.03333333333333333,-5.566666666666666,-5.533333333333333]}),te=()=>{window.confetti({origin:{y:1},zIndex:1057})},ne=(n=15)=>{let o=n*1e3,c=Date.now()+o,r=ee(),f=["#FFC0CB","#FF1493","#C71585"],s=(l,p)=>Math.random()*(p-l)+l;(function l(){let p=c-Date.now();f.forEach(m=>{window.confetti({particleCount:1,startVelocity:0,ticks:Math.max(50,75*(p/o)),origin:{x:Math.random(),y:Math.abs(Math.random()-p/o)},zIndex:1057,colors:[m],shapes:[r],drift:s(-.5,.5),gravity:s(.5,1),scalar:s(.5,1)})}),p>0&&requestAnimationFrame(l)})()},ae=n=>{if(!window.confetti)return;let o=Date.now()+25,c=Math.max(.3,Math.min(1,n.getBoundingClientRect().top/window.innerHeight+.2)),r=ee(),f=["#FF69B4","#FF1493"];(function s(){f.forEach(l=>{window.confetti({particleCount:2,angle:60,spread:55,shapes:[r],origin:{x:0,y:c},zIndex:1057,colors:[l]}),window.confetti({particleCount:2,angle:120,spread:55,shapes:[r],origin:{x:1,y:c},zIndex:1057,colors:[l]})}),Date.now()<o&&requestAnimationFrame(s)})()};var W=(()=>{let n=null,o=async f=>{let s=f.firstElementChild,l=f.lastElementChild,p=f.getAttribute("data-uuid"),m=parseInt(s.getAttribute("data-count-like"));f.disabled=!0,n.has(p)?await O(X,"/api/comment/"+n.get(p)).token(S.getToken()).send(M.statusResponse).then(h=>{h.data.status&&(n.unset(p),l.classList.remove("fa-solid","text-danger"),l.classList.add("fa-regular"),s.setAttribute("data-count-like",String(m-1)))}):await O(U,"/api/comment/"+p).token(S.getToken()).send(M.uuidResponse).then(h=>{h.code===V&&(n.set(p,h.data.uuid),l.classList.remove("fa-regular"),l.classList.add("fa-solid","text-danger"),s.setAttribute("data-count-like",String(m+1)))}),s.innerText=s.getAttribute("data-count-like"),f.disabled=!1};return{init:()=>{n=L("likes")},love:o,tapTap:async f=>{if(!navigator.onLine)return;let s=Date.now(),l=s-parseInt(f.getAttribute("data-tapTime")),p=f.id.replace("body-content-",""),m=l<300&&l>0,h=!n.has(p)&&f.getAttribute("data-liked")!=="true";if(m&&h){navigator.vibrate&&navigator.vibrate(100),ae(f);let w=document.querySelector(`[onclick="undangan.comment.like.love(this)"][data-uuid="${p}"]`);f.setAttribute("data-liked","true"),await o(w),f.setAttribute("data-liked","false")}f.setAttribute("data-tapTime",s)}}})();var _=(()=>{let n=10,o=0,c=0,r=null,f=null,s=null,l=null,p=e=>{n=Number(e)},m=()=>n,h=()=>o,w=()=>c,b=()=>f.classList.contains("disabled")?null:f.classList.add("disabled"),u=()=>f.classList.contains("disabled")?f.classList.remove("disabled"):null,d=()=>s.classList.contains("disabled")?null:s.classList.add("disabled"),y=()=>s.classList.contains("disabled")?s.classList.remove("disabled"):null,x=()=>{l.classList.contains("d-none")&&l.classList.remove("d-none")},v=e=>{e.disabled=!0;let i=e.innerHTML;e.innerHTML='<span class="spinner-border spinner-border-sm my-0 mx-1 p-0" style="height: 0.8rem; width: 0.8rem;"></span>';let T=async()=>{await q.show(),e.disabled=!1,e.innerHTML=i,q.scroll()};return{next:async()=>{o+=n,e.innerHTML="Next"+e.innerHTML,await T(),r.innerText=String(parseInt(r.innerText)+1)},prev:async()=>{o-=n,e.innerHTML=e.innerHTML+"Prev",await T(),r.innerText=String(parseInt(r.innerText)-1)}}};return{init:()=>{l=document.getElementById("pagination"),l.innerHTML=`
        <ul class="pagination mb-2 shadow-sm rounded-4">
            <li class="page-item disabled" id="previous">
                <button class="page-link rounded-start-4" onclick="undangan.comment.pagination.previous(this)" data-offline-disabled="false">
                    <i class="fa-solid fa-circle-left me-1"></i>Prev
                </button>
            </li>
            <li class="page-item disabled">
                <span class="page-link text-theme-auto" id="page">1</span>
            </li>
            <li class="page-item" id="next">
                <button class="page-link rounded-end-4" onclick="undangan.comment.pagination.next(this)" data-offline-disabled="false">
                    Next<i class="fa-solid fa-circle-right ms-1"></i>
                </button>
            </li>
        </ul>`,r=document.getElementById("page"),f=document.getElementById("previous"),s=document.getElementById("next")},setPer:p,getPer:m,getNext:h,reset:async()=>o===0?!1:(o=0,c=0,r.innerText=1,d(),b(),await q.show(),!0),setResultData:e=>{if(c=e,o>0&&u(),c<n){d();return}y(),x()},getResultData:w,previous:async e=>{b(),!(o<0)&&(d(),await v(e).prev())},next:async e=>{d(),!(c<n)&&(b(),await v(e).next())}}})();var q=(()=>{let n=null,o=null,c=null,r=null,f=()=>'<div class="text-center p-4 my-2 bg-theme-auto rounded-4 shadow"><p class="fw-bold p-0 m-0" style="font-size: 0.95rem;">Yuk bagikan undangan ini biar banyak komentarnya</p></div>',s=(a,t)=>{document.querySelector(`[data-button-action="${a}"]`).childNodes.forEach(g=>{g.disabled=t})},l=()=>document.getElementById("comments").scrollIntoView({behavior:"smooth"}),p=a=>{a.comments&&a.comments.forEach(p);let t=document.getElementById(`body-content-${a.uuid}`);t.addEventListener("touchend",()=>W.tapTap(t))},m=async a=>{if(!confirm("Are you sure?"))return;let t=a.getAttribute("data-uuid");S.isAdmin()&&n.set(t,a.getAttribute("data-own")),s(t,!0);let g=$.disableButton(a),e=document.querySelector(`[onclick="undangan.comment.like.love(this)"][data-uuid="${t}"]`);if(e.disabled=!0,!await O(Y,"/api/comment/"+n.get(t)).token(S.getToken()).send(M.statusResponse).then(A=>A.data.status,()=>!1)){g.restore(),e.disabled=!1;return}document.querySelectorAll('a[onclick="undangan.comment.showOrHide(this)"]').forEach(A=>{let P=A.getAttribute("data-uuids").split(",");if(P.find(D=>D===t)){let D=P.filter(B=>B!==t).join(",");D.length===0?A.remove():A.setAttribute("data-uuids",D)}}),n.unset(t),document.getElementById(t).remove();let T=document.getElementById("comments");T.children.length===0&&(T.innerHTML=f())},h=async a=>{let t=a.getAttribute("data-uuid"),g=!1,e=document.getElementById(`form-inner-presence-${t}`);e&&(e.disabled=!0,g=e.value==="1");let i=document.getElementById(`form-${t?`inner-${t}`:"comment"}`),T=!1,A=document.getElementById(`badge-${t}`);if(A&&(T=A.classList.contains("text-success")),t&&$.base64Encode(i.value)===i.getAttribute("data-original")&&T===g){s(t,!1),document.getElementById(`inner-${t}`).remove();return}i.disabled=!0;let P=document.querySelector(`[onclick="undangan.comment.cancel('${t}')"]`);P&&(P.disabled=!0);let D=$.disableButton(a),B=await O(Z,"/api/comment/"+n.get(t)).token(S.getToken()).body(M.updateCommentRequest(e?g:null,i.value)).send(M.statusResponse).then(oe=>oe.data.status,()=>!1);if(i.disabled=!1,P&&(P.disabled=!1),e&&(e.disabled=!1),D.restore(),!B)return;s(t,!1),document.getElementById(`inner-${t}`).remove();let C=document.querySelector(`[onclick="undangan.comment.showMore(this, '${t}')"]`),I=R.convertMarkdownToHTML($.escapeHtml(i.value)),N=document.getElementById(`content-${t}`);if(I.length>R.maxCommentLength?(N.innerHTML=C?.getAttribute("data-show")==="false"?I.slice(0,R.maxCommentLength)+"...":I,N.setAttribute("data-comment",$.base64Encode(I)),C?.style.display==="none"&&(C.style.display="block")):(N.innerHTML=I,N.removeAttribute("data-comment"),C?.style.display==="block"&&(C.style.display="none")),e&&(document.getElementById("form-presence").value=g?"1":"2",L("information").set("presence",g)),!(!e||!A)){if(g){A.classList.remove("fa-circle-xmark","text-danger"),A.classList.add("fa-circle-check","text-success");return}A.classList.remove("fa-circle-check","text-success"),A.classList.add("fa-circle-xmark","text-danger")}},w=async a=>{let t=a.getAttribute("data-uuid"),g=document.getElementById("form-name"),e=g.value;if(S.isAdmin()&&(e=o.get("name")),e.length===0){t&&document.getElementById("comment").scrollIntoView({behavior:"smooth"}),alert("Silakan masukkan nama Anda.");return}let i=document.getElementById("form-presence");if(!t&&i&&i.value==="0"){alert("Silakan pilih status kehadiran Anda.");return}!t&&g&&!S.isAdmin()&&(g.disabled=!0),i&&i.value!=="0"&&(i.disabled=!0);let T=document.getElementById(`form-${t?`inner-${t}`:"comment"}`);T.disabled=!0;let A=document.querySelector(`[onclick="undangan.comment.cancel('${t}')"]`);A&&(A.disabled=!0);let P=$.disableButton(a),D=i?i.value==="1":!0;if(!S.isAdmin()){let C=L("information");C.set("name",e),t||C.set("presence",D)}let B=await O(U,"/api/comment").token(S.getToken()).body(M.postCommentRequest(t,e,D,T.value)).send(M.getCommentResponse).then(C=>C,()=>null);if(g&&(g.disabled=!1),T.disabled=!1,A&&(A.disabled=!1),i&&(i.disabled=!1),P.restore(),!(!B||B.code!==V)){if(n.set(B.data.uuid,B.data.own),T.value=null,!t){if(await _.reset()){l();return}let I=document.getElementById("comments");_.setResultData(I.children.length),_.getResultData()===_.getPer()&&I.lastElementChild.remove(),B.data.is_admin=S.isAdmin(),I.innerHTML=R.renderContent(B.data)+I.innerHTML,l()}if(t){r.set("hidden",r.get("hidden").concat([M.commentShowMore(B.data.uuid,!0)])),r.set("show",r.get("show").concat([t])),s(t,!1),document.getElementById(`inner-${t}`).remove(),B.data.is_admin=S.isAdmin(),document.getElementById(`reply-content-${t}`).insertAdjacentHTML("beforeend",R.renderInnerContent(B.data));let C=document.getElementById(`button-${t}`),I=C.querySelector("a"),N=[B.data.uuid];I&&(I.getAttribute("data-show")==="false"&&x(I),I.remove()),C.querySelector(`button[onclick="undangan.comment.like.love(this)"][data-uuid="${t}"]`).insertAdjacentHTML("beforebegin",R.renderReadMore(t,I?I.getAttribute("data-uuids").split(",").concat(N):N))}p(B.data)}},b=a=>{let t=document.getElementById(`form-inner-${a}`),g=!1,e=document.getElementById(`form-inner-presence-${a}`);e&&(g=e.value==="1");let i=!1,T=document.getElementById(`badge-${a}`);T&&(i=T.classList.contains("text-success")),(t.value.length===0||$.base64Encode(t.value)===t.getAttribute("data-original")&&i===g||confirm("Are you sure?"))&&(s(a,!1),document.getElementById(`inner-${a}`).remove())},u=a=>{let t=a.getAttribute("data-uuid");document.getElementById(`inner-${t}`)||(s(t,!0),document.getElementById(`button-${t}`).insertAdjacentElement("afterend",R.renderReply(t)))},d=async a=>{let t=a.getAttribute("data-uuid");if(document.getElementById(`inner-${t}`))return;s(t,!0);let g=$.disableButton(a);await O(j,"/api/comment/"+t).token(S.getToken()).send(M.commentResponse).then(e=>{if(e.code!==z)return;document.getElementById(`button-${t}`).insertAdjacentElement("afterend",R.renderEdit(t,e.data.presence));let i=document.getElementById(`form-inner-${t}`);i.value=e.data.comment,i.setAttribute("data-original",$.base64Encode(e.data.comment))}),g.restore(),a.disabled=!0},y=()=>{let a=document.getElementById("comments");return a.getAttribute("data-loading")==="false"&&(a.setAttribute("data-loading","true"),a.innerHTML=R.renderLoading().repeat(_.getPer())),O(j,`/api/comment?per=${_.getPer()}&next=${_.getNext()}`).token(S.getToken()).send(M.getCommentsResponse).then(t=>{if(_.setResultData(t.data.length),a.setAttribute("data-loading","false"),t.data.length===0)return a.innerHTML=f(),t;let g=(e,i)=>(e.forEach(T=>{i.find(A=>A.uuid===T.uuid)||i.push(M.commentShowMore(T.uuid)),T.comments&&T.comments.length>0&&g(T.comments,i)}),i);return r.set("hidden",g(t.data,r.get("hidden"))),a.innerHTML=t.data.map(e=>R.renderContent(e)).join(""),t.data.forEach(E),t.data.forEach(p),t})},x=a=>{let t=a.getAttribute("data-uuids").split(","),g=a.getAttribute("data-show")==="true",e=a.getAttribute("data-uuid");g?(a.setAttribute("data-show","false"),a.innerText="Show replies",a.innerText+=" ("+t.length+")",r.set("show",r.get("show").filter(i=>i!==e))):(a.setAttribute("data-show","true"),a.innerText="Hide replies",r.set("show",r.get("show").concat([e])));for(let i of t){r.set("hidden",r.get("hidden").map(A=>(A.uuid===i&&(A.show=!g),A)));let T=document.getElementById(i).classList;g?T.add("d-none"):T.remove("d-none")}},v=(a,t)=>{let g=document.getElementById(`content-${t}`),e=$.base64Decode(g.getAttribute("data-comment")),i=a.getAttribute("data-show")==="false";g.innerHTML=i?e:e.slice(0,R.maxCommentLength)+"...",a.innerText=i?"Sebagian":"Selengkapnya",a.setAttribute("data-show",i?"true":"false")},E=a=>{S.isAdmin()&&(a.comments&&a.comments.forEach(E),!(a.ip===void 0||a.user_agent===void 0||a.is_admin||c.has(a.ip))&&fetch(`https://freeipapi.com/api/json/${a.ip}`).then(t=>t.json()).then(t=>{let g=t.cityName+" - "+t.regionName;t.cityName==="-"&&t.regionName==="-"&&(g="localhost"),c.set(a.ip,g),document.getElementById(`ip-${a.uuid}`).innerHTML=`<i class="fa-solid fa-location-dot me-1"></i>${$.escapeHtml(a.ip)} <strong>${g}</strong>`}).catch(t=>{document.getElementById(`ip-${a.uuid}`).innerHTML=`<i class="fa-solid fa-location-dot me-1"></i>${$.escapeHtml(a.ip)} <strong>${$.escapeHtml(t.message)}</strong>`}))};return{like:W,pagination:_,init:()=>{W.init(),R.init(),_.init(),n=L("owns"),o=L("user"),c=L("tracker"),r=L("comment"),r.has("hidden")||r.set("hidden",[]),r.has("show")||r.set("show",[])},scroll:l,cancel:b,send:w,edit:d,reply:u,remove:m,update:h,show:y,showMore:v,showOrHide:x}})();var se=(()=>{let n=null,o=()=>{let d=document.getElementById("count-down")?.getAttribute("data-time")?.replace(" ","T");if(!d){alert("invalid count down date.");return}let y=new Date(d).getTime();setInterval(()=>{let x=Math.abs(y-Date.now());document.getElementById("day").innerText=Math.floor(x/(1e3*60*60*24)),document.getElementById("hour").innerText=Math.floor(x%(1e3*60*60*24)/(1e3*60*60)),document.getElementById("minute").innerText=Math.floor(x%(1e3*60*60)/(1e3*60)),document.getElementById("second").innerText=Math.floor(x%(1e3*60)/1e3)},1e3)},c=(d,y=.01)=>{let x=document.getElementById(d),v=parseFloat(x.style.opacity),E=null;E=setInterval(()=>{if(v>0){x.style.opacity=v.toFixed(3),v-=y;return}clearInterval(E),E=null,x.remove()},10)},r=()=>{let d=window.location.search.split("to="),y=null;if(d.length>1&&d[1].length>=1&&(y=window.decodeURIComponent(d[1])),y){let v=document.getElementById("guest-name"),E=document.createElement("div");E.classList.add("m-2"),E.innerHTML=`
                <small class="mt-0 mb-1 mx-0 p-0">${v?.getAttribute("data-message")}</small>
                <p class="m-0 p-0" style="font-size: 1.5rem">${$.escapeHtml(y)}</p>
            `,v?.appendChild(E)}let x=document.getElementById("form-name");x&&(x.value=n.get("name")??y)},f=d=>{d.disabled=!0,document.body.scrollIntoView({behavior:"instant"}),F.isAutoMode()&&(document.getElementById("button-theme").style.display="block"),G.init(),F.spyTop(),te(),c("welcome",.025),$.timeOut(ne,1500)},s=d=>{let y=document.getElementById("show-modal-image");y.src=d.src,y.width=d.width,y.height=d.height,K.modal("modal-image").show()},l=()=>n.set("info",!0),p=()=>{document.querySelectorAll(".font-arabic").forEach(d=>{d.innerHTML=String(d.innerHTML).normalize("NFC")})},m=()=>{document.querySelectorAll("svg").forEach(d=>{$.timeOut(()=>d.classList.add(d.getAttribute("data-class")),parseInt(d.getAttribute("data-time")))})},h=()=>{let d=v=>new Date(v+"Z").toISOString().replace(/[-:]/g,"").split(".")[0],y=new URL("https://calendar.google.com/calendar/render"),x={action:"TEMPLATE",text:"The Wedding of Wahyu and Riski",dates:"2023-03-15 10:00:00/2023-03-15 11:00:00",details:"Tanpa mengurangi rasa hormat, kami mengundang Anda untuk berkenan menghadiri acara pernikahan kami. Terima kasih atas perhatian dan doa restu Anda, yang menjadi kebahagiaan serta kehormatan besar bagi kami.",location:"https://goo.gl/maps/ALZR6FJZU3kxVwN86",ctz:"Asia/Jakarta"};x.dates=`${d(x.dates.split("/")[0])}/${d(x.dates.split("/")[1])}`,Object.entries(x).forEach(([v,E])=>y.searchParams.set(v,E)),document.querySelector("#home button")?.addEventListener("click",()=>window.open(y,"_blank"))},w=()=>{m(),o(),r(),p(),h(),document.getElementById("root").style.opacity="1",n.has("presence")&&(document.getElementById("form-presence").value=n.get("presence")?"1":"2"),n.get("info")&&document.getElementById("information")?.remove(),window.AOS.init(),document.body.scrollIntoView({behavior:"instant"}),c("loading",.025)},b=()=>{Q.init(),H.init(),n=L("information");let d=document.body.getAttribute("data-key");if(document.addEventListener("progress.done",()=>w()),document.addEventListener("hide.bs.modal",()=>document.activeElement?.blur()),(!d||d.length<=0)&&(J.init().load(),document.getElementById("comment")?.remove(),document.querySelector('a.nav-link[href="#comment"]')?.closest("li.nav-item")?.remove()),d.length>0){H.add(),H.add();let y=J.init();y.hasDataSrc()||y.load();let x=new URLSearchParams(window.location.search);S.setToken(x.get("k")??d),window.addEventListener("load",()=>S.guest().then(()=>{H.complete("config"),y.hasDataSrc()&&y.load(),q.init(),q.show().then(()=>H.complete("comment")).catch(()=>H.invalid("comment"))}).catch(()=>H.invalid("config")))}};return{init:()=>(F.init(),S.init(),S.isAdmin()&&(L("user").clear(),L("owns").clear(),L("likes").clear(),L("session").clear(),L("comment").clear(),L("tracker").clear()),window.addEventListener("DOMContentLoaded",b),{util:$,theme:F,comment:q,guest:{open:f,modal:s,closeInformation:l}})}})();(n=>{n.undangan=se.init()})(window);})();
